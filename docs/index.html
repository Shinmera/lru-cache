<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Lru Cache</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.project #system #author label{vertical-align:top;}article.project #system #author ul{display:inline-block;margin:0;padding:0;list-style:none;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}</style> </head> <body> <article class="project"> <header>   <h1>lru cache</h1>   <span class="version">1.0.0</span>    <p class="description">A least-recently-used cache structure</p>   </header> <section id="documentation"><article><h1 id="about">About</h1><p>This is an implementation of a least-recently-used cache datastructure, useful for tracking a limited set of resource allocations with minimal evictions.</p><p>See <code><a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">lru-cache</a></code>, <code><a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAKE-LRU-CACHE" class="xref">make-lru-cache</a></code>, etc.</p></article></section>   <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">1.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li></ul> </div>   <div class="row" id="author"> <label for="author">Author:</label> <a href="mailto:shinmera@tymoon.eu">Nicolas Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/shinmera/lru-cache/blob/HEAD/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://shinmera.github.io/lru-cache/">https://shinmera.github.io/lru-cache/</a> </div>   <div class="row"> <label for="bug-tracker">Bug Tracker:</label> <a id="bug-tracker" href="https://github.com/shinmera/lru-cache/issues">https://github.com/shinmera/lru-cache/issues</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/shinmera/lru-cache.git">https://github.com/shinmera/lru-cache.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE ORG.SHIRAKUMO.LRU-CACHE"> <header> <h3> <a href="#PACKAGE%20ORG.SHIRAKUMO.LRU-CACHE">ORG.SHIRAKUMO.LRU-CACHE</a> </h3> <ul class="nicknames"></ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition structure" id="STRUCTURE ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">STRUCTURE</span> <h4 class="name"> <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE">LRU-CACHE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L41">Source</a>  </header> <div class="docstring"><pre>A least-recently-used cache datastructure.

See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAKE-LRU-CACHE" class="xref">MAKE-LRU-CACHE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-SIZE" class="xref">LRU-CACHE-SIZE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-PUSH" class="xref">LRU-CACHE-PUSH</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-POP" class="xref">LRU-CACHE-POP</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-ID" class="xref">LRU-CACHE-ID</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-EVICT" class="xref">LRU-CACHE-EVICT</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-CLEAR" class="xref">LRU-CACHE-CLEAR</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-COUNT" class="xref">LRU-CACHE-COUNT</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAP-LRU-CACHE" class="xref">MAP-LRU-CACHE</a>
See <a href="#MACRO-FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ADO-LRU-CACHE" class="xref">DO-LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-CLEAR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-CLEAR">LRU-CACHE-CLEAR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L140">Source</a>  </header> <div class="docstring"><pre>Evicts all elements in the cache and clears it.

This operation is O(n).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-COUNT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-COUNT">LRU-CACHE-COUNT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L157">Source</a>  </header> <div class="docstring"><pre>Counts the number of elements currently in the cache.

This operation is O(n).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-SIZE" class="xref">LRU-CACHE-SIZE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-EVICT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-EVICT">LRU-CACHE-EVICT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L127">Source</a>  </header> <div class="docstring"><pre>Evicts the least recently used element from the cache.

Returns the element and the ID of the evicted node, if any.

This operation is O(n).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-ID"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-ID">LRU-CACHE-ID</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VALUE</li>    <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L150">Source</a>  </header> <div class="docstring"><pre>Returns the ID of the node the element is in.

If the element is not in the cache, NIL is returned.

This operation is O(1).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-POP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-POP">LRU-CACHE-POP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VALUE</li>    <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L102">Source</a>  </header> <div class="docstring"><pre>Pops an element out of the cache.

If the element exists in the cache, the ID of the node is returned. If
the element did not exist in the cache, NIL is returned.

This operation is O(1).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-PUSH" class="xref">LRU-CACHE-PUSH</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-PUSH"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-PUSH">LRU-CACHE-PUSH</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VALUE</li>    <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L72">Source</a>  </header> <div class="docstring"><pre>Pushes an element to the cache.

The element is put into the cache as the most recently used. If the
element did not exist before and the cache is already full, the least
recently used element is evicted.

Returns the ID of the node the element was put into, if it was not
already in the cache. If the element was already in the cache, NIL is
returned.

This operation is O(1).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-POP" class="xref">LRU-CACHE-POP</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-SIZE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-SIZE">LRU-CACHE-SIZE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">INSTANCE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L41">Source</a>  </header> <div class="docstring"><pre>Returns the size of the cache.

This operation is O(1).

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:MAKE-LRU-CACHE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAKE-LRU-CACHE">MAKE-LRU-CACHE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SIZE</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">TEST</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L61">Source</a>  </header> <div class="docstring"><pre>Create a new LRU-CACHE instance that can hold SIZE elements.

The TEST may be one of the arguments acceptable as the TEST of a
hash-table.

See <a href="http://l1sp.org/cl/hash-table-test" class="xref">CL:HASH-TABLE-TEST</a>
See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.LRU-CACHE:MAP-LRU-CACHE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAP-LRU-CACHE">MAP-LRU-CACHE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">CACHE</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L166">Source</a>  </header> <div class="docstring"><pre>Iterates over the cached elements in order from most recent to least recent.

Calls FUNCTION with two values: the element and the ID of the node the
element occupies. Note that the ID does *not* necessarily correspond
to the index of the node in the cache sequence.

Returns the CACHE instance.

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a>
See <a href="#MACRO-FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ADO-LRU-CACHE" class="xref">DO-LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION ORG.SHIRAKUMO.LRU-CACHE:DO-LRU-CACHE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3ADO-LRU-CACHE">DO-LRU-CACHE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">ELEMENT</li>  <li class="argument">ID</li>  <li class="argument">CACHE</li>  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">RESULT</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>  </ul>  <a class="source-link" href="https://github.com/shinmera/lru-cache/blob/HEAD/lru-cache.lisp#L181">Source</a>  </header> <div class="docstring"><pre>Convenience macro to iterate over the cached elements in order from most recent to least recent.

An implicit NIL block is bound around BODY.
If BODY does not explicitly return, RESULT is evaluated and returned instead.

See <a href="#STRUCTURE%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE" class="xref">LRU-CACHE</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.LRU-CACHE%3AMAP-LRU-CACHE" class="xref">MAP-LRU-CACHE</a></pre></div> </article> </li>  <li> <article class="definition source-transform" id="SOURCE-TRANSFORM ORG.SHIRAKUMO.LRU-CACHE:LRU-CACHE-SIZE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SOURCE-TRANSFORM</span> <h4 class="name"> <a href="#SOURCE-TRANSFORM%20ORG.SHIRAKUMO.LRU-CACHE%3ALRU-CACHE-SIZE">LRU-CACHE-SIZE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition source-transform" id="SOURCE-TRANSFORM ORG.SHIRAKUMO.LRU-CACHE:(SETF LRU-CACHE-SIZE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SOURCE-TRANSFORM</span> <h4 class="name"> <a href="#SOURCE-TRANSFORM%20ORG.SHIRAKUMO.LRU-CACHE%3A%28SETF%20LRU-CACHE-SIZE%29">(SETF LRU-CACHE-SIZE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li> </ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 